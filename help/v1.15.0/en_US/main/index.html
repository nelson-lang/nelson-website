<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nelson Help</title>
  <style>
    body {
      margin: 0;
      display: flex;
      height: 100vh;
    }
    #left-frame {
      width: 250px;
      min-width: 0;
      border-right: 1px solid #ccc;
      height: 100%;
      transition: width 0.3s;
      background: #fafafa;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    #left-frame.collapsed {
      width: 0;
      min-width: 0;
      border-right: none;
    }
    #main-frame {
      flex: 1;
      height: 100%;
      position: relative;
      display: flex;
      flex-direction: column;
    }
    #collapse-btn {
      position: absolute;
      top: 10px;
      left: 0;
      width: 30px;
      height: 30px;
      cursor: pointer;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    iframe {
      width: 100%;
      height: 100%;
      border: none;
      display: block;
    }
    .search-container {
      position: absolute;
      top: 10px;
      right: 90px;
      z-index: 100;
      display: flex;
    }
    .search-container input {
      padding: 6px;
      width: 180px;
      border: 1px solid #ccc;
      border-radius: 4px 0 0 4px;
      outline: none;
    }
    .search-container button {
      padding: 6px 10px;
      background: #0078d7;
      color: white;
      border: none;
      border-radius: 0 4px 4px 0;
      cursor: pointer;
    }
    .search-container button:hover {
      background: #0063b1;
    }
  </style>
</head>
<body>
  <div id="left-frame">
    <iframe id="tocFrame" src="toc.html"></iframe>
  </div>
  <div id="main-frame">
    <button id="collapse-btn" title="Collapse/Expand Menu">&#9776;</button>
    <iframe id="contentFrame" name="contentFrame" src="homepage.html"></iframe>
    <div class="search-container">
      <form onsubmit="searchHelp(document.getElementById('search-input').value); return false;">
        <input type="text" id="search-input" placeholder="Search help..." aria-label="Search help">
        <button type="submit" title="Search">Search</button>
      </form>
    </div>
  </div>
  <script>
    // Collapsible left frame logic, button always visible on main frame
    const leftFrame = document.getElementById('left-frame');
    const collapseBtn = document.getElementById('collapse-btn');
    let collapsed = false;
    collapseBtn.addEventListener('click', function() {
      collapsed = !collapsed;
      leftFrame.classList.toggle('collapsed', collapsed);
      collapseBtn.innerHTML = collapsed ? '&#9776;' : '&#9654;';
      collapseBtn.title = collapsed ? 'Expand Menu' : 'Collapse Menu';
    });
  </script>
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      const params = new URLSearchParams(window.location.search);
      const searchTerm = params.get('search');
      const openPage = params.get('open');
      
      if (searchTerm) {
        document.getElementById('search-input').value = searchTerm;
      }
      
      if (openPage) {
        navigateToPage(openPage);
      } else if (searchTerm) {
        searchHelp(searchTerm);
      }
      
      // Add keyboard shortcut for focusing search (Ctrl+F or Command+F)
      window.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
          e.preventDefault(); // Prevent default browser search
          document.getElementById('search-input').focus();
        }
      });
    });
    
    function searchHelp(term) {
      if (!term || term.trim() === '') {
        alert('Please enter a search term');
        return;
      }
      
      var contentFrame = document.getElementById('contentFrame');
      if (contentFrame) {
        var searchUrl = 'search_results.html?query=' + encodeURIComponent(term.trim());
        contentFrame.src = searchUrl;
        
        // Update URL with search parameter for bookmarking/sharing
        const url = new URL(window.location);
        url.searchParams.set('search', term.trim());
        window.history.replaceState({}, '', url);
      } else {
        alert('Error: Content frame not found');
      }
    }
    
    function navigateToPage(pagePath) {
      var contentFrame = document.getElementById('contentFrame');
      if (contentFrame) {
        contentFrame.src = pagePath;
      }
    }
  </script>
</body>
</html>
